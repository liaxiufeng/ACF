!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t){e.exports=require("querystring")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("https")},function(e,t){e.exports=require("child_process")},function(e,t,n){const a=window.devicePixelRatio;function r(e,t,n){var a=function(r){r.stopPropagation(),n(r),e.removeEventListener(t,a),a=null};return e.addEventListener(t,a),a}function i(e,t,n,a){if(0!=e.rename.length&&t.set(e.rename,n),void 0!==e.isSaveHistory){if(0==e.isSaveHistory.length)var r=path.basename(n);else r=e.newFileName;if("actuator"==sysConfig.category)var i=incident.getDirectory()+"/"+incident.getJobId();else i=incident.getDirectory()+"/savehistory";fs.existsSync(i)||fs.mkdirSync(i),fileOperateNew.copy_rename_file(n,i,r,a)}else a()}function o(e,t,n){if(-1!=e.indexOf("@")){let n=/@\S+/g;var a=e.match(n),r=new Set;a.forEach(function(e){var t=e.replace("@","");r.add(t)}),r.forEach(function(n){var a=t.get(n);if(void 0!==a){"[object Array]"==Object.prototype.toString.call(a)&&(a=JSON.stringify(a).replace("[","").replace("]","")),"number"==typeof a&&(a=JSON.stringify(a)),a=a.replace(/,/g,"，");var r=new RegExp("@"+n+"\\s","g");e=e.replace(r,a)}})}n(null,e.replace(/ /g," ").trim())}function c(e,t){(0,n(3).exec)(sysPath.CShandle+'/uispy.exe -m foucs -v "'+JSON.stringify(e.parameters).replace(/"/g,"'")+'"',{encoding:"binary"},function(e,n,a){if(e)return t(errorStack("ElementNotFoundException",e instanceof Error?a:e));void 0===n&&(n="",console.warn("cs参数stdout为undefined")),void 0===a&&(a="",console.warn("cs参数stderr为undefined"));var r=iconv.decode(n,"GBK");iconv.decode(a,"GBK");t(null,r)})}function s(e,t){exec(e,{encoding:"binary"},function(e,n,a){if(e)return t(errorStack("ElementNotFoundException",e instanceof Error?a:e));let r="";try{r=iconv.decode(n,"GBK");var i=JSON.parse(r);if(500==i.code)return t(errorStack("ElementNotFoundException",i.msg));t(null,i.context)}catch(e){return t(errorStack("ElementNotFoundException","错误的回传信息："+r))}})}$("#main-body").on("click",".webview-pages i",function(){if(void 0===$(this).parents("li").attr("index"))return;let e=$(this).parents("li").attr("index");$("#foo"+e).remove(),$(this).parents("li").remove(),setTimeout(()=>{$(".webview-pages li").last().click(),webview=$("webview").last()[0]},0)}),$("#main-body").on("click",".webview-pages li",function(){let e=$(this).attr("index");if($(".webview-pages").find("li").removeClass("page-selected"),$(this).addClass("page-selected"),$("body webview").addClass("webview-hide"),void 0===e){webview=$("#foo")[0];try{webview.focus()}catch(e){console.log(e)}$("#foo").removeClass("webview-hide")}else{webview=$("#foo"+e)[0];try{webview.focus()}catch(e){console.log(e)}$("#foo"+e).removeClass("webview-hide")}}),incident.addEVent("click",function(e,t,n){r(webview,"ipc-message",function(n){n.stopPropagation(),200==n.channel.code?fs.readFile(sysConfig.rootPath+"/app/main/debuger/Scalable/actuator.js",function(n,a){if(n)throw n;a+=";action("+JSON.stringify(e)+");",webview.executeJavaScript(a,!0,function(e){t()})}):incident.webAction(n.channel)});let a=setInterval(()=>{null==webview||webview.isLoading()||(clearInterval(a),webview.send("action",e))},500);null==webview||webview.isLoading()||(clearInterval(a),webview.send("action",e))}),incident.addEVent("chromeOp",function(e,t,n){if(r(webview,"ipc-message",function(e){e.stopPropagation(),incident.webAction(e.channel)}),"hand"==e.parameters.userGesture)fs.readFile(sysConfig.rootPath+"/app/main/debuger/Scalable/actuator.js",function(n,a){if(n)throw n;a+=";action("+JSON.stringify(e)+");",webview.executeJavaScript(a,!0,function(e){t()})});else{let t=setInterval(()=>{null==webview||webview.isLoading()||(clearInterval(t),webview.send("action",e))},500);null==webview||webview.isLoading()||(clearInterval(t),webview.send("action",e))}}),incident.addEVent("clipboardWaitTime",function(e,t,n){worker.incident.setGlobalContext("clipboardWaitTime",e.parameters.sleep),t()}),incident.addEVent("globalWaitTime",function(e,t,n){worker.globalWaitTime=e.parameters.WaitTime,worker.globalFloatWaitTime=e.parameters.floatWaitTime,t()}),incident.addEVent("waitTime",function(e,t,n){setTimeout(()=>{t()},e.parameters.sleep)}),incident.addEVent("closePage",function(e,t,n){let a=$(".page-selected").attr("index");void 0!==a?($(".page-selected").remove(),$("#foo"+a).remove(),$(".webview-pages li").each((e,n)=>{a-1==1?($(n).click(),webview=$("#foo")[0],webview.focus(),t()):$(n).attr("index")==a-1&&($(n).click(),webview=$("#foo"+(a-1))[0],webview.focus(),t())})):t()}),incident.addEVent("importFile",function(e,t,n){"actuator"!=sysConfig.category?(e.parameters.CShandle=sysPath.CShandle,officeUtil.readTableData(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})):(n.set(e.parameters.rename,e.parameters.filePath),t())}),incident.addEVent("importFile_normal",function(e,t,n){e.parameters.CShandle=sysPath.CShandle,officeUtil.readTableData(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("importTextFile",function(e,t,n){"actuator"!=sysConfig.category?(e.parameters.CShandle=sysPath.CShandle,officeUtil.readTableData(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})):(n.set(e.parameters.rename,e.parameters.filePath),t())}),incident.addEVent("importTextFile_normal",function(e,t,n){e.parameters.CShandle=sysPath.CShandle,officeUtil.readTableData(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("exportFile",function(e,t,n){console.log(e.parameters.valueParam),officeUtil.writeFile(e.parameters,function(a,r){a?t(a):i(e.parameters,n,r,t)})}),incident.addEVent("saveNewParam",function(e,t,n){paramUtil.doSaveNewParam(e.parameters.paramValue,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("saveAccount",function(e,t,n){n.set(e.parameters.rename+"账号",e.parameters.usernameValue),n.set(e.parameters.rename+"密码",e.parameters.pwdValue),t()}),incident.addEVent("calculateParam",function(e,t,n){paramUtil.doCalculateParam(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("simpleFormula",function(e,t,n){paramUtil.simpleFormula(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("convertParam",function(e,t,n){paramUtil.doConvertParam(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("extractParam",function(e,t,n){paramUtil.doExtractParam(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("callFunction",function(e,t,n){paramSwitchUtil.doParamSwitch(e.parameters,function(a,r){a?t(a):(console.log(e.parameters.rename,r),n.set(e.parameters.rename,r),t())})}),incident.addEVent("confirmSend",function(e,t,n){o(e.parameters.html,n,function(n,a){e.parameters.html=a,systemParamUtil.doSendEmail(e.parameters,function(e,n,a){e?t(e):t()})})}),incident.addEVent("confirmReceive",function(e,t,n){e.parameters.rootdirectory=incident.getDirectory(),systemParamUtil.doReceiveEmail(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("getSystemParameter",function(e,t,n){systemParamUtil.getSystemParame(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("CSMoveForChildName",function(e,t,n){let a=sysPath.CShandle+'/uispy.exe -m findChildByName -v "'+JSON.stringify(e.parameters).replace(/"/g,"'").replace("childname","name")+'"';exec(a,{encoding:"binary"},function(e,n,a){if(e)return t(errorStack("ElementNotFoundException",e instanceof Error?a:e));try{json=JSON.parse(n),200==json.code?(CSRobotUtil.cs.click(),t()):t(errorStack("ElementNotFoundException",json))}catch(e){t(errorStack("ClassCastException",e))}})}),incident.addEVent("CSMoveForName",function(e,t,n){let a=sysPath.CShandle+'/uispy.exe -m findByName -v "'+JSON.stringify(e.parameters).replace(/"/g,"'")+'"';exec(a,{encoding:"binary"},function(e,n,a){if(e)return t(errorStack("ElementNotFoundException",e instanceof Error?a:e));try{json=JSON.parse(n),200==json.code?(CSRobotUtil.cs.click(),t()):t(errorStack("ElementNotFoundException",json))}catch(e){t(errorStack("ClassCastException",e))}})}),incident.addEVent("CSMoveForVerify",function(e,t,n){let a=sysPath.CShandle+'/uispy.exe -m verifyFocus -v "'+JSON.stringify(e.parameters).replace(/"/g,"'")+'"';exec(a,{encoding:"binary"},function(a,r,i){if(a)return t(errorStack("ElementNotFoundException",a instanceof Error?i:a));try{console.log(r),r=r.replace(/\r\n/g,"");let a=JSON.parse(r);n.set(e.parameters.rename,200==a.code),t()}catch(e){t(errorStack("ClassCastException",e))}})}),incident.addEVent("ActuatorForVerify",function(e,t,n){let a=sysPath.CShandle+'/uispy.exe -m verifyFocus -v "'+JSON.stringify(e.parameters).replace(/"/g,"'")+'"';exec(a,{encoding:"binary"},function(e,n,a){if(e)return console.log(e),e=iconv.decode(e,"GBK"),console.log("发送自定义事件"),void ipc.send("fuzhu_actutor_alert","haha");try{console.log(n),n=n.replace(/\r\n/g,""),200==JSON.parse(n).code?t():(console.log("发送自定义事件"),ipc.send("fuzhu_actutor_alert","haha"),ipc.on("continue_do_fuzhu_pre",function(e,n){"yes"==n?(console.log(n),t()):(console.log(n),t(errorStack("ClassCastException")))}))}catch(e){t(errorStack("ClassCastException",e))}})}),incident.addEVent("CSMoveForRelative",function(e,t,n){temp=e.parameters.relative.split(","),x=parseInt(temp[0]),y=parseInt(temp[1]),c(e,function(e,n){if(e)return void t(e);let a;try{void 0===(a=JSON.parse(n)).code||200==a.code?(void 0!==a.code&&(a=a.msg),console.log(a,a.X+a.Width/2,x),CSRobotUtil.cs.moveMouse(a.X+a.Width/2+x,a.Y+a.Height/2+y),CSRobotUtil.cs.click(),t()):t(errorStack("ElementNotFoundException",a))}catch(e){t(errorStack("ElementNotFoundException","无法获取句柄"))}})}),incident.addEVent("CSmove",function(e,t,n){temp=e.parameters.rectangle.split(","),x=temp[0],y=temp[1],""!=e.parameters.path.trim()?c(e,function(n,a){if(n)return void t(n);let r;try{if(void 0===(r=JSON.parse(a)).code||200==r.code)void 0!==r.code&&(r=r.msg),console.log(r,r.X+r.Width/2,x),CSRobotUtil.cs.moveMouse(r.X+r.Width/2,r.Y+r.Height/2),CSRobotUtil.cs.click(),t();else{if(e.parameters.mouseMove)throw a;console.error("无法获取句柄"+a),t(errorStack("ElementNotFoundException",r))}}catch(n){e.parameters.mouseMove&&CSRobotUtil.cs.moveMouse(x,y),e.parameters.mouseClick&&CSRobotUtil.cs.click(),t()}}):(e.parameters.mouseMove&&CSRobotUtil.cs.moveMouse(x,y),e.parameters.mouseClick&&CSRobotUtil.cs.click(),t())}),incident.addEVent("CSMove_element",function(e,t,n){void 0!==e.parameters.rename&&n.set(e.parameters.rename,e.parameters.winTitle),temp=e.parameters.rectangle.split(","),x=temp[0],y=temp[1],c(e,function(n,a){if(n)return void t(n);let r;try{if(void 0===(r=JSON.parse(a)).code||200==r.code)void 0!==r.code&&(r=r.msg),console.log(r,r.X+r.Width/2,x),CSRobotUtil.cs.moveMouse(r.X+r.Width/2,r.Y+r.Height/2),CSRobotUtil.cs.click(),t();else{if(e.parameters.mouseMove)throw a;console.error("无法获取句柄"+a),t(errorStack("ElementNotFoundException",r))}}catch(n){e.parameters.mouseMove&&CSRobotUtil.cs.moveMouse(x,y),e.parameters.mouseClick&&CSRobotUtil.cs.click(),t()}})}),incident.addEVent("CSmove_position",function(e,t,n){temp=e.parameters.rectangle.split(","),x=temp[0],y=temp[1],e.parameters.mouseMove&&CSRobotUtil.cs.moveMouse(x,y),e.parameters.mouseClick&&CSRobotUtil.cs.click(),t()}),incident.addEVent("mouseRoll",function(e,t,n){temp=e.parameters.rectangle.split(","),x=temp[0],y=temp[1],""!=e.parameters.path.trim()?c(e,function(n){n?t(n):(CSRobotUtil.cs.scroll(e.parameters.mouseRollUpOrDown,e.parameters.mouseRollLeftOrRight),t())}):(CSRobotUtil.cs.scroll(e.parameters.mouseRollUpOrDown,e.parameters.mouseRollLeftOrRight),t())}),incident.addEVent("openApplication",function(e,t,n){let a=setTimeout(()=>{t()},1e3),r=path.parse(e.parameters.openPath);console.log('cd /d "'+r.dir+'" && "'+r.base+'"'),exec("cd /d "+r.dir+" && "+r.base,{encoding:"binary"},(e,n,r)=>{if(e)return clearTimeout(a),t(errorStack("IllegalAccessException",e instanceof Error?r:e))})}),incident.addEVent("CMDcommand",function(e,t,n){let a=e.parameters.command;exec(a,{encoding:"binary"},(a,r,i)=>{if(err)return clearTimeout(timeout),t(errorStack("IllegalAccessException",err instanceof Error?i:err));{void 0===r&&(r="",console.warn("CMDcommand参数stdout为undefined"));let a=iconv.decode(r,"GBK");n.set(e.parameters.rename,a),t()}})}),incident.addEVent("closeApplication",function(e,t,n){exec('tasklist | find "'+e.parameters.closePath+'"',{encoding:"binary"},function(n,a,r){if(n)return t(errorStack("IllegalAccessException",err instanceof Error?r:err));""!=a&&exec('taskkill /f /t /im "'+e.parameters.closePath+'"',{encoding:"binary"},function(e,n,a){if(e)return clearTimeout(timeout),t(errorStack("IllegalAccessException",e instanceof Error?a:e));t()})})}),incident.addEVent("mouseClick",function(e,t,n){switch(e.parameters.mouseClickType){case"leftClick":CSRobotUtil.cs.click();break;case"midClick":CSRobotUtil.cs.click("middle");break;case"rightClick":CSRobotUtil.cs.click("right");break;case"leftDbclick":CSRobotUtil.cs.dbclick()}setTimeout(()=>{t()})}),incident.addEVent("shortCut",function(e,t,n){let a=e.parameters.hotKey.split("+");for(let e in a)a[e]=a[e].trim();let r=e.parameters.interval||300,i=a.splice(0,a.length-1);if(1==e.parameters.count)CSRobotUtil.cs.comKey(a[a.length-1],i),t();else for(let n=0;n<e.parameters.count;n++)setTimeout(()=>{CSRobotUtil.cs.comKey(a[a.length-1],i),e.parameters.count-1==n&&t()},r*n+100)}),incident.addEVent("copyOrpasteDo",function(e,t,n){"ctrlC"==e.parameters.ctrlCOrV?CSRobotUtil.cs.CtrlC():CSRobotUtil.cs.CtrlV(),t()}),incident.addEVent("paramsCopy",function(e,t,n){CSRobotUtil.cs.CtrlC(e.parameters.paramName),setTimeout(()=>{t()},n.get("clipboardWaitTime")||300)}),incident.addEVent("paramsPaste",function(e,t,n){testStr=systemParamUtil.getClipboard(),void 0!==e.parameters.isFormat&&"on"===e.parameters.isFormat||(testStr=testStr.replace(/[\r\n]/g,"")),setTimeout(()=>{n.set(e.parameters.rename,testStr),t()},500)}),incident.addEVent("httpApi",function(e,t,a){let r,i,o=e.parameters,c={},s=!1,d=URL.parse(o.httpUrl);"https:"!==d.protocol&&"http:"!==d.protocol&&(d=URL.parse("http://"+o.url));for(let e in o)if(e.includes("key")){let t=e.replace(/[^0-9]/gi,"");if(""==o[e])continue;c[o[e]]=o["value"+t],s=!0}i="https:"==d.protocol?n(2):n(1),r="application/json; charset=utf-8"==o.ContentType?JSON.stringify(c):n(0).stringify(c);var l={host:d.hostname,port:d.port,path:d.path,method:o.httpType||"POST",headers:{"Content-Type":o.ContentType}},p="",m=i.request(l,function(e){e.setEncoding("utf8"),e.on("data",function(e){p+=e}),e.on("end",function(){200==e.statusCode?("json"==o.paramType?a.set(o.rename,JSON.parse(p)):a.set(o.rename,p),t()):t(errorStack("WEBException",{status:e.statusCode,msg:e.statusMessage}))}),e.on("error",function(e){t(errorStack("WEBException",e))})});m.on("error",function(e){t(errorStack("WEBException",e))}),s&&m.write(r),m.end()}),incident.addEVent("setColParam",function(e,t,n){let a=n.signature(e.parameters.paramName),r=[];for(let t in e.parameters)if(t.includes("key")){let n=t.replace(/[^0-9]/gi,"");r.push({key:e.parameters[t],value:e.parameters["value"+n]})}var i=[],o={};"["==a[0]?(i=e.parameters.paramName,r.forEach(e=>{i[e.key]=e.value}),n.setOwnProperty(e.parameters.rename,i)):"{"==a[0]&&(o=e.parameters.paramName,r.forEach(e=>{o[e.key]=e.value}),n.setOwnProperty(e.parameters.rename,o)),t()}),incident.addEVent("arrayConcat",function(e,t,n){e.inputInfo.length;let a=[],r=[];for(let t in e.parameters)if(t.includes("value")){let n=t.replace(/[^0-9]/gi,"");a.push({value:e.parameters["value"+n]})}for(var i=0;i<a.length;i++)r=r.concat(a[i].value);n.set(e.parameters.rename,r),t()}),incident.addEVent("IDAccountPassword",function(e,t,n){n.set("账号-"+e.parameters.ID,e.parameters.username),n.set("密码-"+e.parameters.ID,e.parameters.password),void 0!==e.parameters.attache&&0!=e.parameters.attache.length&&n.set("归属地-"+e.parameters.ID,e.parameters.attache),void 0!==e.parameters.department&&0!=e.parameters.department.length&&n.set("部门-"+e.parameters.ID,e.parameters.department),t()}),incident.addEVent("groupPassword",function(e,t,n){"actuator"==sysConfig.category?(n.set(e.parameters.rename,e.parameters.group),t()):util.httpPost.post("/api/selectByGroup/"+encodeURI(e.parameters.groupId),function(a,r){if(a)return console.error(a,r),void t(errorStack("WEBException",a));n.set(e.parameters.rename,JSON.parse(r)),t()})}),incident.addEVent("koulingxuanze",function(e,t,n){n.get(e.parameters.group).forEach(a=>{a.commandName===e.parameters.rename&&(n.set(e.parameters.rename+"账号",a.commandName),n.set(e.parameters.rename+"密码",AESUtil.aesDecrypt(a.password)),n.set(e.parameters.rename+"归属地",a.attache),t())})}),incident.addEVent("dbConfig",function(e,t,n){dbForMenuUtil.db_config(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("dbSelect",function(e,t,n){dbForMenuUtil.db_select(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("dbOthers",function(e,t,n){dbForMenuUtil.db_others(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("dbInsert",function(e,t,n){dbForMenuUtil.db_insert(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("socketApi",function(e,t,n){dataInterfaceUtil.socketInterface.start(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("websocketApi",function(e,t,n){dataInterfaceUtil.websocketInterface.start(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("getPixelColor",function(e,t,n){e.parameters.devicePixelRatio=a,CSRobotUtil.getPixelColor.get_pixel_color(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("fs_cre_directory",function(e,t){fileOperateNew.create_directory(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("fs_cre_file",function(e,t){fileOperateNew.create_file(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("fs_move",function(e,t){fileOperateNew.move_file(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("fs_rename",function(e,t){fileOperateNew.rename_file(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("fs_delete",function(e,t){fileOperateNew.delete_file(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("fs_delete_dir",function(e,t){fileOperateNew.fs_delete_dir(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("fs_exists",function(e,t,n){fileOperateNew.exists_file(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("fs_copy",function(e,t){fileOperateNew.copy_file(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("fs_get_all_file",function(e,t,n){fileOperateNew.get_all_file(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("PreciseWriteFile",function(e,t){officeUtil.PreciseWriteFile(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("PreciseReadFile",function(e,t,n){officeUtil.PreciseReadFile(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("readPDF",function(e,t,n){officeUtil.readPDF(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("copyExclePart",function(e,t,n){officeUtil.copyExclePart(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("changeStyleExcle",function(e,t,n){e.parameters.CShandle=sysPath.CShandle,officeUtil.changeStyleExcle(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("callback_pixel_position",function(e,t,n){e.parameters.devicePixelRatio=a,CSRobotUtil.CallbackPixelPosition.callback_pixel_position(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("string_generacte",function(e,t,n){o(e.parameters.html,n,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("throwError",function(e,t,n){t(errorStack(e.parameters.errType,e.parameters.errDesc))}),incident.addEVent("draftingMouse",function(e,t,n){e.parameters.devicePixelRatio=a,CSRobotUtil.cs.draftingMouse(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("capScreenPart",function(e,t,n){e.parameters.devicePixelRatio=a,CSRobotUtil.cs.capScreenPart(e.parameters,function(a,r){if(a)t(a);else{let a=document.createElement("canvas"),o=a.width=r.width,c=a.height=r.height,s=a.getContext("2d"),d=s.getImageData(0,0,o,c);d.data.set(r.image),s.putImageData(d,0,0);let l=a.toDataURL("image/png",1).replace(/^data:image\/\w+;base64,/,"");void 0!==l&&""!=l||(l="",console.warn("capScreenPart base64Data为空或undefined"));let p=new Buffer(l,"base64");fs.writeFile(incident.getDirectory()+"/"+e.parameters.fileName+".png",p,function(a){a?t(a):i(e.parameters,n,incident.getDirectory()+"/"+e.parameters.fileName+".png",function(e,n){e?t(e):t()})})}})}),incident.addEVent("slidingVerificationCode",function(e,t,n){e.parameters.rootdirectory=incident.getDirectory(),CSRobotUtil.cs.slidingVerificationCode(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("conArrayRowCol",function(e,t,n){paramUtil.conArrayRowCol(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("archiverFile",function(e,t,n){fileOperateNew.archiverFile(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("unarchiverFile",function(e,t,n){fileOperateNew.unarchiverFile(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("strSplit",function(e,t,n){paramUtil.strSplit(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_open",function(e,t,n){exec('reg query "HKLM\\SOFTWARE\\Microsoft\\Internet Explorer" /v svcVersion',{encoding:"binary"},function(e,t,a){if(e)n.set("_IE_version","8");else{let e=iconv.decode(t,"GBK").split(" "),a=e[e.length-1].split(".")[0];n.set("_IE_version",a)}}),ie8Util.open(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("ie8_click",function(e,t,n){ie8Util.click(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("ie8_waitFindAlert",function(e,t,n){ie8Util.waitFindAlert(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())})}),incident.addEVent("ie8_waitFindELe",function(e,t,n){ie8Util.waitFindELe(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())})}),incident.addEVent("ie8_inputInfo",function(e,t,n){ie8Util.inputInfo(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("ie8_historyBack",function(e,t,n){ie8Util.historyBack(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("ie8_pageFresh",function(e,t,n){ie8Util.pageFresh(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("ie8_quitBrowser",function(e,t,n){ie8Util.quitBrowser(e.parameters,function(e,n){e?t(e):t()})}),incident.addEVent("ie8_getPageURL",function(e,t,n){ie8Util.getPageURL(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_strReturnXpath",function(e,t,n){ie8Util.strReturnXpath(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_getPageCookies",function(e,t,n){ie8Util.getPageCookies(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_InnerHTML",function(e,t,n){ie8Util.InnerHTML(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_canGetEle",function(e,t,n){ie8Util.canGetEle(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_mouseover",function(e,t,n){ie8Util.mouseover(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_classReturnXpath",function(e,t,n){ie8Util.classReturnXpath(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_getAttributeName",function(e,t,n){ie8Util.getAttributeName(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_changeAttributeName",function(e,t,n){ie8Util.changeAttributeName(e.parameters,function(e,n){e?t(e):t()},n)}),incident.addEVent("ie8_closePage",function(e,t,n){ie8Util.closePage(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_getAlertText",function(e,t,n){ie8Util.getAlertText(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_operateAlert",function(e,t,n){ie8Util.operateAlert(e.parameters,function(e,n){e?t(e):t()},n)}),incident.addEVent("ie8_openIframe",function(e,t,n){ie8Util.openIframe(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_selectOption",function(e,t,n){ie8Util.selectOption(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_getVCode",function(e,t,n){ie8Util.getVCode(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_getList",function(e,t,n){ie8Util.getList(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_getTable",function(e,t,n){ie8Util.getTable(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_resemblance",function(e,t,n){ie8Util.resemblance(e.parameters,function(a,r){a?t(a):(console.log(r),n.set(e.parameters.rename,r),t())},n)}),incident.addEVent("ie8_test",function(e,t,n){ie8Util.test(e.parameters,function(e,n){e?t(e):t()},n)}),incident.addEVent("ie8_swichTo",function(e,t,n){ie8Util.swichTo(e.parameters,function(e,n){e?t(e):t()},n)}),incident.addEVent("openExecuteWindow",function(e,t,n){remote.getCurrentWindow().show(),t()}),incident.addEVent("closeExecuteWindow",function(e,t,n){remote.getCurrentWindow().hide(),t()}),incident.addEVent("newHttpApi",function(e,t,n){dataInterfaceUtil.httpInterface.httpApi(e.parameters,function(a,r){if(a)return t(a);n.set(e.parameters.rename,r),t()})}),incident.addEVent("http_uploadfile",function(e,t,n){dataInterfaceUtil.httpInterface.upload(e.parameters,function(a,r){if(a)return t(a);n.set(e.parameters.rename,r),t()})}),incident.addEVent("http_downloadfile",function(e,t,n){dataInterfaceUtil.httpInterface.download(e.parameters,function(a,r){if(a)return t(a);console.log(r),n.set(e.parameters.rename,r),t()})}),incident.addEVent("backGlobalParam",function(e,t,n){incident.setGlobalContext(e.parameters.rename,e.parameters.paramValue),t()}),incident.addEVent("getCSElement",function(e,t,n){s(sysPath.CShandle+'/uispy.exe -m getCSElement -v "'+JSON.stringify(e.parameters).replace(/"/g,"'"),function(a,r){if(a)return t(a);n.set(e.parameters.rename,r),t()})}),incident.addEVent("getCSParentElementByName",function(e,t,n){s(sysPath.CShandle+'/uispy.exe -m getCSParentElementByName -v "'+JSON.stringify(e.parameters.Element).replace(/"/g,"'")+'" -n "'+e.parameters.elName+'" -e "'+e.parameters.eventType+'"',function(a,r){if(a)return t(a);n.set(e.parameters.rename,r),t()})}),incident.addEVent("getCSBrotherElementByName",function(e,t,n){s(sysPath.CShandle+'/uispy.exe -m getCSBrotherElementByName -v "'+JSON.stringify(e.parameters.Element).replace(/"/g,"'")+'" -n "'+e.parameters.elName+'" -i "'+e.parameters.index+'" -b "'+(!!e.parameters.isSameType&&"false"!=e.parameters.isSameType)+'" -e "'+e.parameters.eventType+'"',function(a,r){if(a)return t(a);n.set(e.parameters.rename,r),t()})}),incident.addEVent("getCSChildrenElementByName",function(e,t,n){s(sysPath.CShandle+'/uispy.exe -m getCSChildrenElementByName -v "'+JSON.stringify(e.parameters.Element).replace(/"/g,"'")+'" -n "'+e.parameters.elName+'" -i "'+e.parameters.index+'" -b "'+(!!e.parameters.isSameType&&"false"!=e.parameters.isSameType)+'" -e "'+e.parameters.eventType+'"',function(a,r){if(a)return t(a);n.set(e.parameters.rename,r),t()})}),incident.addEVent("getCSParentElement",function(e,t,n){s(sysPath.CShandle+'/uispy.exe -m getCSParentElement -v "'+JSON.stringify(e.parameters.Element).replace(/"/g,"'")+'"',function(a,r){if(a)return t(a);n.set(e.parameters.rename,r),t()})}),incident.addEVent("getCSBrotherElement",function(e,t,n){s(sysPath.CShandle+'/uispy.exe -m getCSBrotherElement -v "'+JSON.stringify(e.parameters.Element).replace(/"/g,"'")+'" -e '+e.parameters.eventType,function(a,r){if(a)return t(a);n.set(e.parameters.rename,r),t()})}),incident.addEVent("getCSChildrenElement",function(e,t,n){s(sysPath.CShandle+'/uispy.exe -m getCSChildrenElement -v "'+JSON.stringify(e.parameters.Element).replace(/"/g,"'")+'" -e '+e.parameters.eventType,function(a,r){if(a)return t(a);n.set(e.parameters.rename,r),t()})}),incident.addEVent("getElementItems",function(e,t,n){s(sysPath.CShandle+'/uispy.exe -m getComBoxList -v "'+JSON.stringify(e.parameters.Element).replace(/"/g,"'")+'" -e '+e.parameters.eventType,function(a,r){if(a)return t(a);n.set(e.parameters.rename,r),t()})}),incident.addEVent("CSElemetClick",function(e,t,n){s(sysPath.CShandle+'/uispy.exe -m focusWindow -v "'+JSON.stringify(e.parameters.Element).replace(/"/g,"'")+'"',function(n,a){if(n)return t(n);let r=e.parameters.Element.pos.split(",");switch(CSRobotUtil.cs.moveMouse(r[0],r[1]),e.parameters.mouseClickType){case"leftClick":CSRobotUtil.cs.click();break;case"midClick":CSRobotUtil.cs.click("middle");break;case"rightClick":CSRobotUtil.cs.click("right");break;case"leftDbclick":CSRobotUtil.cs.dbclick()}t()})}),incident.addEVent("CSElemetInput",function(e,t,n){if("input"!==e.parameters.inputType){s(sysPath.CShandle+'/uispy.exe -m focusInElement -v "'+JSON.stringify(e.parameters.Element).replace(/"/g,"'")+'"',function(n,a){if(n)return t(n);"keybord"===e.parameters.inputType?CSRobotUtil.cs.inputText(e.parameters.input):(CSRobotUtil.cs.CtrlC(e.parameters.input),CSRobotUtil.cs.CtrlV()),t()})}else{s(sysPath.CShandle+'/uispy.exe -m writeInElement -v "'+JSON.stringify(e.parameters.Element).replace(/"/g,"'")+'" -t "'+e.parameters.input+'"',function(e,n){if(e)return t(e);t()})}}),incident.addEVent("shangdongMenu",function(e,t,n){s(sysPath.CShandle+'/uispy.exe -m shangdongMenu -v "'+JSON.stringify(e.parameters.Element).replace(/"/g,"'")+'" -n "'+e.parameters.elName+'" -e "'+e.parameters.eventType+'"',function(a,r){if(a)return t(a);n.set(e.parameters.rename,r),t()})}),incident.addEVent("numTrans",function(e,t,n){paramUtil.numTrans(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("dateFormatSpe",function(e,t,n){paramUtil.dateFormatSpe(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("getIp",function(e,t,n){systemParamUtil.getIp(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("returnParameterToCenter",function(e,t,n){"actuator"==sysConfig.category?(worker.retArray.push(e.parameters.parameter),t()):t()}),incident.addEVent("openMstscReport",function(e,t,n){"actuator"==sysConfig.category?t():(ipc.send("showLogPage"),systemParamUtil.getIp(null,function(e,n){if(e)return t(e);{let e=n[0],t="http://"+e+":813/getTaskInfo?ip="+e+"&port=81&jobId="+worker.id;setTimeout(function(){ipc.send("openLogPage",t)},500)}}),t())}),incident.addEVent("openTips",function(e,t,n){"actuator"==sysConfig.category?(ipc.send("rpa_action_alert","string"==typeof e.parameters.parameter?e.parameters.parameter:JSON.stringify(e.parameters.parameter)),ipc.on("continue_do_fuzhu_pre",function(e,n){t()})):layer.msg("string"==typeof e.parameters.parameter?e.parameters.parameter:JSON.stringify(e.parameters.parameter),{time:3e3,icon:1,title:" ",area:"auto",maxWidth:800,maxHeight:700,skin:"layer-ext-clearData",btn:["确定"],end:function(e){layer.close(e),t()}})}),incident.addEVent("triggerScript",function(e,t,n){"actuator"==sysConfig.category?getMac({active:!0},function(n,a){let r=[{name:"robotIp",value:getIp().join(",")},{name:"robotMac",value:a.join(",")},{name:"createUser",value:void 0===sysConfig.userId?(new Date).getTime():confidInfo.sysConfig.userId},{name:"scriptId",value:e.parameter.scriptId},{name:"jobName",value:"自动触发"+(new Date).getTime()},{name:"jobType",value:"1"}];httpAjax.ajax({url:"/job/insertJob",type:"post",data:r,processData:!1},function(e,n){if("string"==typeof n&&(n=JSON.parse(n)),e)return t(e||"发布失败");n.success?t():t(n.msg||"发布失败")})}):t()}),incident.addEVent("excelChangeSheet",function(e,t,n){newOfficeUtil.excelChangeSheet(e.parameters,function(e,a){e?t(e):(a.forEach(function(e,t){n.set(t,e)}),t())})}),incident.addEVent("readCsvFile",function(e,t,n){newOfficeUtil.readCsvFile(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("excelCreateSheet",function(e,t,n){newOfficeUtil.excelCreateSheet(e.parameters,function(e,a){e?t(e):(a.forEach(function(e,t){n.set(t,e)}),t())})}),incident.addEVent("excelWriteCell",function(e,t,n){newOfficeUtil.excelWriteCell(e.parameters,function(e,a){e?t(e):(a.forEach(function(e,t){n.set(t,e)}),t())})}),incident.addEVent("excelReadCell",function(e,t,n){newOfficeUtil.excelReadCell(e.parameters,function(e,a){e?t(e):(a.forEach(function(e,t){n.set(t,e)}),t())})}),incident.addEVent("excelReadSheet",function(e,t,n){newOfficeUtil.excelReadSheet(e.parameters,function(e,a){e?t(e):(a.forEach(function(e,t){n.set(t,e)}),t())})}),incident.addEVent("excelWriteSheet",function(e,t,n){newOfficeUtil.excelWriteSheet(e.parameters,function(e,a){e?t(e):(a.forEach(function(e,t){n.set(t,e)}),t())})}),incident.addEVent("excelReadRange",function(e,t,n){newOfficeUtil.excelReadRange(e.parameters,function(e,a){e?t(e):(a.forEach(function(e,t){n.set(t,e)}),t())})}),incident.addEVent("excelwriteRange",function(e,t,n){newOfficeUtil.excelwriteRange(e.parameters,function(e,a){e?t(e):(a.forEach(function(e,t){n.set(t,e)}),t())})}),incident.addEVent("excelWriteRowCol",function(e,t,n){newOfficeUtil.excelWriteRowCol(e.parameters,function(e,a){e?t(e):(a.forEach(function(e,t){n.set(t,e)}),t())})}),incident.addEVent("excelCopyPart",function(e,t,n){newOfficeUtil.excelCopyPart(e.parameters,function(e,a){e?t(e):(a.forEach(function(e,t){n.set(t,e)}),t())})}),incident.addEVent("excelDeleRowCol",function(e,t,n){newOfficeUtil.excelDeleRowCol(e.parameters,function(e,a){e?t(e):(a.forEach(function(e,t){n.set(t,e)}),t())})}),incident.addEVent("writeCsvFile",function(e,t,n){console.log(e.parameters.valueParam),newOfficeUtil.writeCsvFile(e.parameters,function(a,r){a?t(a):i(e.parameters,n,r,t)})}),incident.addEVent("docWriteTxt",function(e,t,n){docOfficeUtil.docWriteTxt(e.parameters,function(a,r){a?t(a):i(e.parameters,n,r,t)})}),incident.addEVent("docWriteWord",function(e,t,n){docOfficeUtil.docWriteWord(e.parameters,function(a,r){a?t(a):i(e.parameters,n,r,t)})}),incident.addEVent("docReadWord",function(e,t,n){e.parameters.CShandle=sysPath.CShandle,docOfficeUtil.docReadWord(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("docReadTxt",function(e,t,n){docOfficeUtil.docReadTxt(e.parameters,function(a,r){a?t(a):(n.set(e.parameters.rename,r),t())})}),incident.addEVent("similarSelector",function(e,t,n){systemParamUtil.similarSelector(e.parameters,function(a,r){if(a)return t(a);n.set(e.parameters.rename,r),t()})}),incident.addEVent("getScriptInfo",function(e,t,n){n.set(e.parameters.rename,{id:worker.scriptInfo.id,name:worker.scriptInfo.title,type:worker.scriptInfo.typeName}),t()}),incident.addEVent("ftpUpload",function(e,t,n){dataInterfaceUtil.ftpInterface.uploadFile({host:e.parameters.host,port:e.parameters.port,user:e.parameters.user,pass:e.parameters.pass},e.parameters.remotePath,e.parameters.localPath,e.parameters.fileNmae,function(e,n){if(e)return t(e);t()})}),incident.addEVent("ftpDownLoad",function(e,t,n){dataInterfaceUtil.ftpInterface.downLoad({host:e.parameters.host,port:e.parameters.port,user:e.parameters.user,pass:e.parameters.pass},e.parameters.remotePath,e.parameters.localPath,e.parameters.fileNmae,function(e,n){if(e)return t(e);t()})}),incident.addEVent("ocr_TencentCloud_getString",function(e,t,n){ocrUtil.tencentCloudApi.getString(e.parameters,function(a,r){if(a)return t(a);n.set(e.parameters.rename,r),t()})}),incident.addEVent("ocr_TencentCloud_getPosition",function(e,t,n){ocrUtil.tencentCloudApi.getPosition(e.parameters,function(a,r){if(a)return t(a);n.set(e.parameters.rename,r),t()})}),incident.addEVent("triggerJava",function(e,t,n){let a=setTimeout(()=>{t()},1e3),r=path.parse(e.parameters.openPath);exec("cd /d "+r.dir+" && java -jar "+r.base,{encoding:"binary"},(e,n,r)=>{if(e)return clearTimeout(a),t(errorStack("IllegalAccessException",e instanceof Error?r:e))})}),incident.addEVent("triggerBatVbs",function(e,t,n){let a=setTimeout(()=>{t()},1e3),r=path.parse(e.parameters.openPath),i=".bat"==r.ext?r.base:"cscript "+r.base;exec("cd /d "+r.dir+" && "+i,{encoding:"binary"},(e,n,r)=>{if(e){console.log(e);let n=iconv.decode(e,"GBK");return clearTimeout(a),t(errorStack("IllegalAccessException",n))}})}),incident.addEVent("telnetConnect",function(e,t,n){let a=dataInterfaceUtil.telnetInterface;a.connect(e.parameters.host,e.parameters.port,e.parameters.username,e.parameters.password,function(r){if(r)return t(r);n.set(e.parameters.rename,a),t()})}),incident.addEVent("telnetWrite",function(e,t,n){e.parameters.telnetClient.write(e.parameters.cmdStr,function(a,r){if(a)return t(a);n.set(e.parameters.rename,r),t()})}),incident.addEVent("telnetClose",function(e,t,n){e.parameters.telnetClient.disConnect(),t()}),incident.addEVent("wordCopyInClip",function(e,t,n){s(sysPath.CShandle+'/uispy.exe -m wordCopyInClip -p "'+e.parameters.file+'"',function(e,n){if(e)return t(e);t()})})},function(e,t){onload=function(){Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},ipc.on("step",function(e,t){document.getElementById("main-body").innerHTML=`\n            <ul class="webview-pages">\n                <li class="page-selected">\n                    <div class="icon-newlabel"></div>\n                    <span class="page-title">Document</span>\n                    <span class="webview-page-tools">\n                        <i></i>\n                    </span>\n                </li>\n            </ul>\n            <webview id="foo" src="about:blank" minheight="700" preload="../main/debuger/actuator.js" partition="debug${(new Date).getTime()}" userAgent="Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36"></webview>\n        `,webview=document.getElementById("foo"),webviewEvent(webview),worker.init("actuator"==sysConfig.category?t.context:t.json,sysConfig.category,sysConfig.rootDirectory,sysConfig.outTime,t.id,sysConfig.globalWaitTime,t.srciptInfo),ipc.send("logJobHtml",worker.id),worker.Start()}),ipc.on("endJob",function(e,t){worker.id!=t?ipc.send("operateCallback",{code:500,msg:"当前正在执行的脚本不符"}):(ipc.send("operateCallback",{code:200,msg:""}),worker.emit("taskEnd"))}),ipc.on("stopJob",function(e,t){worker.emit("taskStop"),ipc.send("operateCallback",{code:200,msg:""}),setTimeout(()=>{worker.emit("taskGoon")},12e3)}),ipc.on("goonJob",function(e,t){ipc.send("operateCallback",{code:200,msg:""}),worker.emit("taskGoon")}),ipc.on("debugNext",function(e,t){worker.emit("nextDebug")}),ipc.on("debugStop",function(e,t){worker.emit("stopDebug")}),worker.on("forInfo",function(e){ipc.send("forInfo",e)}),worker.on("logInfo",function(e,t){ipc.send("logInfo",{code:200,msg:{step:e,error:t}})}),worker.on("status",function(e){switch(e.type){case"TimeOutFinsh":setTimeout(()=>{ipc.send("actuatorHide",{id:worker.id,status:-1})},1e4);break;case"peopleClose":"actuator"==sysConfig.category?setTimeout(()=>{ipc.send("actuatorHide",{id:worker.id,status:-1})},1e4):webview.send("callbackFlag",!1);break;default:console.log(e)}}),worker.on("debugInfo",function(e){console.log("debuggerInfo:",e)}),worker.on("compeleteyDo",function(e){console.log(`[${(new Date).format("yyyy-MM-dd HH:mm:ss.S")}] compeleteyDo: ${e.type}`)}),worker.on("readyDo",function(e){ipc.send("logInfo",{code:200,msg:"ready do:"+JSON.stringify(e)}),ipc.send("doTargetItem",e),console.log(`[${(new Date).format("yyyy-MM-dd HH:mm:ss.S")}] readyDo: ${e.type}`)}),worker.on("workFailed",function(e){"actuator"==sysConfig.category&&setTimeout(()=>{ipc.send("actuatorHide",{id:worker.id,status:-1})},1e4),ipc.send("logInfo",{code:500,msg:e}),console.log("workFailed:",e),console.log("****************************************************")}),worker.on("workSuccess",function(e){"actuator"==sysConfig.category&&setTimeout(()=>{ipc.send("actuatorHide",{id:worker.id,status:1,result:JSON.stringify(e)})},1e4),ipc.send("logInfo",{code:200,msg:"workflow successed"}),console.log("workSuccess"),console.log("****************************************************")}),window.onerror=function(e,t,n,a,r){var i="错误信息："+e+"\n出错文件："+t+"\n出错行号："+n+"\n出错列号："+a+"\n错误详情："+r+"\n";return(r+"").indexOf("Callback was already called")>-1?(console.log(i+"因解绑问题所产生的报错，可以无视"),!0):(ipc.send("logInfo",{code:500,msg:i}),!1)}}},function(e,t,n){console.log(111),console.log(222),console.log(333),console.log(444),n(5),n(4),console.log(555)},function(e,t,n){e.exports=n(6)}]);